<!-- This page defines the form to create or edit an instance of this module -->
<!-- It is used from /course/mod.php.  The whole instance is available as $form. -->
<?php
    require_once($CFG->dirroot.'/mod/autoview/lib.php');
?>
<form name="form" method="post" action="mod.php">
<table cellpadding="5" align="center" summary="AutoView setup">
<tr valign=top>
    <td align="right"><b><?php  print_string("autoviewtext", "autoview") ?> :</b>
    </td>
    <td align="left" valign="middle">
     <input type="text" size="50" name="content" value="<?php if (isset($form->content)) echo $form->content; ?>" />
    </td>
</tr>
<tr valign=top>
    <td align="right"><b><?php  print_string("autoviewsummary", "autoview") ?> :</b>
    </td>
    <td align="left" valign="middle">
     <?php print_textarea(false, 8, 65, 630, 400, 'summary', $form->summary); ?>
    </td>
</tr>
<tr valign=top>
    <td align="right"><b><?php  print_string("hidenav", "autoview") ?> :</b>
    </td>
    <td align="left" valign="middle">
     <input type="checkbox" name="noframe" value="1" <?php if ($form->noframe) echo "checked"; ?> />
    </td>
</tr>
<tr>
    <td align="right" valign="top" ><b><?php print_string("configfile", "autoview"); ?> :</b></td>
    <td align="left" valign="middle">
       <?php
        if ($add)
         echo '<input type="checkbox" name="createnew" checked'.
          ' onClick="document.form.configfile.disabled=this.checked;document.form.configfilebutton.disabled=this.checked;document.form.usedir.disabled=!this.checked;" />'.
          get_string("createnew", "autoview").'<br />'.
          '<input type="checkbox" name="usedir" checked value="true" />'.get_string("usedir", "autoview").'<br /><br />';
       ?>
       <input type="text" size="50" name="configfile" value="<?php if (isset($form->configfile)) echo $form->configfile; ?>"
        <?php if ($add) echo 'disabled';?> />
       <input type="button" name="configfilebutton" title="<?php print_string("chooseconfig", "autoview"); ?>"
        value="<?php print_string("chooseconfig", "autoview"); ?>"
        onclick="return openpopup('/files/index.php?id=<?php echo $course->id; ?>&amp;choose=form.configfile', 'coursefiles',
       'menubar=0,location=0,scrollbars,resizable,width=750,height=500', 0);" <?php if ($add) echo 'disabled';?> />
    </td>
</tr>
</table>
<p><?php if ($add) print_string("xmlhelp", "autoview"); else print_string("xmlnote", "autoview"); ?></p>
<!-- these hidden variables are always the same -->
<input type="hidden" name="course"        value="<?php  p($form->course) ?>" />
<input type="hidden" name="sesskey"       value="<?php  p($form->sesskey) ?>" />
<input type="hidden" name="coursemodule"  value="<?php  p($form->coursemodule) ?>" />
<input type="hidden" name="section"       value="<?php  p($form->section) ?>" />
<input type="hidden" name="module"        value="<?php  p($form->module) ?>" />
<input type="hidden" name="modulename"    value="<?php  p($form->modulename) ?>" />
<input type="hidden" name="instance"      value="<?php  p($form->instance) ?>" />
<input type="hidden" name="mode"          value="<?php  p($form->mode) ?>" />
<br />
<div align="center"><input type="submit" value="<?php  print_string("update") ?>" /><br /><br />

</form>

<?php 
       if (has_capability('mod/autoview:canedit', $context) && !$add)
       {
          echo "<form action=\"".$CFG->wwwroot."/mod/autoview/view.php\" method=\"get\" onsubmit=\"this.target='_top'; return true;\"><div>".
              "<input type=\"submit\" value=\"".get_string("editbutton", "autoview")."\" />".
              "<input type=\"hidden\" name=\"edit\" value=\"true\" />".
              "<input type=\"hidden\" name=\"id\" value=\"".$form->coursemodule."\" />".
              "</div></form>";
       }

   if ($usehtmleditor) { 
       use_html_editor();
   }
?></div>
